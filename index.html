<!DOCTYPE html>
<html lang="en">
<head>
ย ย <meta charset="UTF-8">
ย ย <meta name="viewport" content="width=device-width, initial-scale=1.0, viewport-fit=cover, maximum-scale=5">
ย ย <meta name="description" content="Book your time slots easily and manage your bookings online">
ย ย <meta name="theme-color" content="#10b981">
ย ย <meta name="apple-mobile-web-app-capable" content="yes">
ย ย <meta name="apple-mobile-web-app-status-bar-style" content="default">
ย ยย
ย ย ย ย ย ย <meta http-equiv="Content-Security-Policy"ย
ย ย ย ย ย content="default-src 'self';ย
ย ย ย ย ย ย ย ย ย ยstyle-src 'self' 'nonce-RANDOM_NONCE' https://fonts.googleapis.com;
ย ย ย ย ย ย ย ย ย ยfont-src 'self' https://fonts.gstatic.com;
ย ย ย ย ย ย ย ย ย ยscript-src 'self' 'nonce-RANDOM_NONCE' https://vercel.live;
ย ย ย ย ย ย ย ย ย ยimg-src 'self' data: blob:;
ย ย ย ย ย ย ย ย ย ยconnect-src 'self';
ย ย ย ย ย ย ย ย ย ยbase-uri 'self';
ย ย ย ย ย ย ย ย ย ยform-action 'self';">
ย ยย
ย ย <title>Book a Slot - Online Booking System</title>

ย ย ย ย <link rel="preconnect" href="https://fonts.googleapis.com">
ย ย <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
ย ยย
ย ย ย ย <link rel="preload" href="user-style.css" as="style">
ย ย <link rel="stylesheet" href="user-style.css">
ย ยย
ย ย ย ย <link rel="preload"ย
ย ย ย ย ย href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap"ย
ย ย ย ย ย as="style"ย
ย ย ย ย ย onload="this.onload=null;this.rel='stylesheet'">
ย ย <noscript>
ย ย ย ย <link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap">
ย ย </noscript>

ย ย <link rel="icon" href="/favicon.ico" type="image/x-icon">
ย ย <link rel="apple-touch-icon" href="/apple-touch-icon.png">

ย ย ย ย <style nonce="RANDOM_NONCE">
ย ย ย ย /* UPDATED: Combined base styles and new utility/inline styles here */
ย ย ย ย body{font-family:-apple-system,BlinkMacSystemFont,'SF Pro Display',Inter,'Segoe UI',sans-serif;margin:0;background:#f8fafc;line-height:1.5;-webkit-font-smoothing:antialiased;-moz-osx-font-smoothing:grayscale;-webkit-tap-highlight-color:transparent}
ย ย ย ย .container{max-width:800px;margin:0 auto;padding:1rem;padding-bottom:calc(120px + env(safe-area-inset-bottom))}
ย ย ย ย h1{font-size:clamp(1.5rem,5vw,2rem);font-weight:700;color:#0f172a;margin-bottom:.5rem;letter-spacing:-.02em;line-height:1.2}
ย ย ย ย #loadingMsg{text-align:center;padding:40px 20px;color:#64748b}
ย ย ย ย .hidden{display:none!important}
ย ย ย ย .visually-hidden{position:absolute;width:1px;height:1px;padding:0;margin:-1px;overflow:hidden;clip:rect(0,0,0,0);white-space:nowrap;border:0}
ย ย ย ย .spinner{display:inline-block;width:20px;height:20px;border:3px solid rgba(16,185,129,.3);border-radius:50%;border-top-color:#10b981;animation:spin .8s ease-in-out infinite}
ย ย ย ย @keyframes spin{to{transform:rotate(360deg)}}
ย ย ย ย /* New styles to replace inline attributes */
ย ย ย ย .mt-15 { margin-top: 15px; } /* Replaces style="margin-top: 15px;" (Error 3, 9) */
ย ย ย ย .h-100 { height: 100px; } /* Replaces style="height: 100px;" (Error 8) */
ย ย ย ย .d-none { display: none; } /* Replaces style="display:none;" (Error 4, 5, 7) */
ย ย ย ย .error-box { text-align: center; padding: 20px; } /* Replaces inline styles in error message (Error 6) */
ย ย ย ย .error-msg-container { padding: 20px; text-align: center; background: #fee2e2; border: 2px solid #ef4444; margin: 20px; border-radius: 12px; } /* Replaces inline styles in noscript fallback */
ย ย </style>
</head>
<body>
<div class="container">
ย ย <header>
ย ย ย ย <h1>๐ Book Your Slot</h1>
ย ย </header>

ย ย <main>
ย ย ย ย ย ย ย ย <section class="card lookup-section card-compact" aria-labelledby="lookup-heading">
ย ย ย ย ย ย <h2 id="lookup-heading" class="visually-hidden">Lookup and Cancel Bookings</h2>
ย ย ย ย ย ย <button id="lookupToggle"ย
ย ย ย ย ย ย ย ย ย ย class="btn secondary-btn full-width-mobile"ย
ย ย ย ย ย ย ย ย ย ย aria-expanded="false"
ย ย ย ย ย ย ย ย ย ย aria-controls="lookupContent"
ย ย ย ย ย ย ย ย ย ย type="button">
ย ย ย ย ย ย ย ย ๐ Look Up / Cancel Booking
ย ย ย ย ย ย </button>
ย ย ย ย ย ย <div id="lookupContent" class="hidden" aria-hidden="true">ย
ย ย ย ย ย ย ย ย ย ย ย ย ย ย ย ย <p class="description mt-15">
ย ย ย ย ย ย ย ย ย ย Enter your phone number to view and manage your bookings.
ย ย ย ย ย ย ย ย </p>
ย ย ย ย ย ย ย ย <div class="lookup-controls">
ย ย ย ย ย ย ย ย ย ย <label for="lookupPhone" class="visually-hidden">Phone number for booking lookup</label>
ย ย ย ย ย ย ย ย ย ย <input type="tel"ย
ย ย ย ย ย ย ย ย ย ย ย ย ย ยid="lookupPhone"ย
ย ย ย ย ย ย ย ย ย ย ย ย ย ยclass="form-input lookup-input"ย
ย ย ย ย ย ย ย ย ย ย ย ย ย ยplaceholder="Enter your phone number"
ย ย ย ย ย ย ย ย ย ย ย ย ย ยmaxlength="20"
ย ย ย ย ย ย ย ย ย ย ย ย ย ยautocomplete="tel"
ย ย ย ย ย ย ย ย ย ย ย ย ย ยinputmode="tel"
ย ย ย ย ย ย ย ย ย ย ย ย ย ยaria-describedby="phone-hint">
ย ย ย ย ย ย ย ย ย ย <span id="phone-hint" class="visually-hidden">
ย ย ย ย ย ย ย ย ย ย ย ย Enter your 10-digit phone number to search for bookings
ย ย ย ย ย ย ย ย ย ย </span>
ย ย ย ย ย ย ย ย ย ย <button id="lookupSearchBtn"ย
ย ย ย ย ย ย ย ย ย ย ย ย ย ย class="btn secondary-btn"ย
ย ย ย ย ย ย ย ย ย ย ย ย ย ย aria-label="Search for bookings"
ย ย ย ย ย ย ย ย ย ย ย ย ย ย type="button">
ย ย ย ย ย ย ย ย ย ย ย ย Search
ย ย ย ย ย ย ย ย ย ย </button>
ย ย ย ย ย ย ย ย </div>
ย ย ย ย ย ย </div>
ย ย ย ย ย ย ย ย ย ย ย ย <div id="userBookingsDisplay"ย
ย ย ย ย ย ย ย ย ยclass="mt-15"ย
ย ย ย ย ย ย ย ย ยrole="region"ย
ย ย ย ย ย ย ย ย ยaria-live="polite"ย
ย ย ย ย ย ย ย ย ยaria-label="Your bookings">
ย ย ย ย ย ย </div>
ย ย ย ย </section>

ย ย ย ย ย ย ย ย <div id="loadingMsg" role="status" aria-live="polite">
ย ย ย ย ย ย <span class="spinner" aria-hidden="true"></span>
ย ย ย ย ย ย <span>Loading available slots...</span>
ย ย ย ย </div>
ย ย ย ย ย ย ย ย <div id="slotsDisplay" class="d-none">
ย ย ย ย ย ย <p class="description">
ย ย ย ย ย ย ย ย Select one or more time slots. You can choose multiple slots across different dates.ย
ย ย ย ย ย ย ย ย <strong>All times shown are in Eastern Time (ET)</strong>.
ย ย ย ย ย ย </p>
ย ย ย ย ย ย <div id="datesContainer" role="region" aria-label="Available time slots"></div>
ย ย ย ย ย ย ย ย ย ย ย ย <div class="h-100" aria-hidden="true"></div>ย
ย ย ย ย </div>
ย ย ย ยย
ย ย ย ย ย ย ย ย ย ย ย ย <div id="floatingSignupBtnContainer" class="d-none" role="region" aria-live="polite">
ย ย ย ย ย ย <button id="floatingSignupBtn"ย
ย ย ย ย ย ย ย ย ย ย class="btn primary-btn"ย
ย ย ย ย ย ย ย ย ย ย type="button"
ย ย ย ย ย ย ย ย ย ย aria-label="Continue to sign up with selected slots">
ย ย ย ย ย ย ย ย Continue to Sign Up (0 Slots Selected)
ย ย ย ย ย ย </button>
ย ย ย ย </div>

ย ย ย ย ย ย ย ย ย ย ย ย <section id="signupSection" class="d-none card" aria-labelledby="signup-heading">
ย ย ย ย ย ย <h2 id="signup-heading">โ๏ธ Enter Your Detailsย</h2>
ย ย ย ย ย ย <div id="selectedSlotSummary"ย
ย ย ย ย ย ย ย ย ยclass="selected-slots-summary"ย
ย ย ย ย ย ย ย ย ยrole="region"ย
ย ย ย ย ย ย ย ย ยaria-label="Selected slots summary">
ย ย ย ย ย ย </div>
ย ย ย ย ย ย <form id="signupForm" novalidate>
ย ย ย ย ย ย ย ย <label for="nameInput" class="visually-hidden">Your Full Name (Required)</label>
ย ย ย ย ย ย ย ย <input type="text"ย
ย ย ย ย ย ย ย ย ย ย ย ยid="nameInput"ย
ย ย ย ย ย ย ย ย ย ย ย ยclass="form-input"ย
ย ย ย ย ย ย ย ย ย ย ย ยplaceholder="Your Full Name *"ย
ย ย ย ย ย ย ย ย ย ย ย ยrequiredย
ย ย ย ย ย ย ย ย ย ย ย ยmaxlength="100"ย
ย ย ย ย ย ย ย ย ย ย ย ยautocomplete="name"ย
ย ย ย ย ย ย ย ย ย ย ย ยaria-required="true"
ย ย ย ย ย ย ย ย ย ย ย ยaria-describedby="name-hint">
ย ย ย ย ย ย ย ย <span id="name-hint" class="visually-hidden">Enter your full name, at least 2 characters</span>

ย ย ย ย ย ย ย ย <label for="phoneInput" class="visually-hidden">Phone Number (Required)</label>
ย ย ย ย ย ย ย ย <input type="tel"ย
ย ย ย ย ย ย ย ย ย ย ย ยid="phoneInput"ย
ย ย ย ย ย ย ย ย ย ย ย ยclass="form-input"ย
ย ย ย ย ย ย ย ย ย ย ย ยplaceholder="Phone Number *"ย
ย ย ย ย ย ย ย ย ย ย ย ยrequiredย
ย ย ย ย ย ย ย ย ย ย ย ยmaxlength="20"ย
ย ย ย ย ย ย ย ย ย ย ย ยautocomplete="tel"ย
ย ย ย ย ย ย ย ย ย ย ย ยinputmode="tel"
ย ย ย ย ย ย ย ย ย ย ย ยaria-required="true"
ย ย ย ย ย ย ย ย ย ย ย ยaria-describedby="phone-signup-hint">
ย ย ย ย ย ย ย ย <span id="phone-signup-hint" class="visually-hidden">Enter your 10-digit phone number</span>

ย ย ย ย ย ย ย ย <label for="emailInput" class="visually-hidden">Your Email Address (Optional)</label>
ย ย ย ย ย ย ย ย <input type="email"ย
ย ย ย ย ย ย ย ย ย ย ย ยid="emailInput"ย
ย ย ย ย ย ย ย ย ย ย ย ยclass="form-input"ย
ย ย ย ย ย ย ย ย ย ย ย ยplaceholder="Your Email Address (Optional)"ย
ย ย ย ย ย ย ย ย ย ย ย ยmaxlength="254"ย
ย ย ย ย ย ย ย ย ย ย ย ยautocomplete="email"
ย ย ย ย ย ย ย ย ย ย ย ยinputmode="email">

ย ย ย ย ย ย ย ย <label for="categorySelect" class="visually-hidden">Select Category (Required)</label>
ย ย ย ย ย ย ย ย <select id="categorySelect"ย
ย ย ย ย ย ย ย ย ย ย ย ย class="form-input"ย
ย ย ย ย ย ย ย ย ย ย ย ย requiredย
ย ย ย ย ย ย ย ย ย ย ย ย aria-required="true">
ย ย ย ย ย ย ย ย ย ย <option value="" disabled selected>-- Select Category * --</option>
ย ย ย ย ย ย ย ย ย ย <option value="Bal">Bal</option>
ย ย ย ย ย ย ย ย ย ย <option value="Balika">Balika</option>
ย ย ย ย ย ย ย ย ย ย <option value="Kishore">Kishore</option>
ย ย ย ย ย ย ย ย ย ย <option value="Kishori">Kishori</option>
ย ย ย ย ย ย ย ย ย ย <option value="Yuvak">Yuvak</option>
ย ย ย ย ย ย ย ย ย ย <option value="Yuvati">Yuvati</option>
ย ย ย ย ย ย ย ย ย ย <option value="Premvati">Premvati</option>
ย ย ย ย ย ย ย ย ย ย <option value="Sanyukta">Sanyukta</option>
ย ย ย ย ย ย ย ย </select>

ย ย ย ย ย ย ย ย <label for="notesInput" class="visually-hidden">Any special notes or comments (Optional)</label>
ย ย ย ย ย ย ย ย <textarea id="notesInput"ย
ย ย ย ย ย ย ย ย ย ย ย ย ย class="form-input"ย
ย ย ย ย ย ย ย ย ย ย ย ย ย placeholder="Any special notes or comments (Optional)"ย
ย ย ย ย ย ย ย ย ย ย ย ย ย rows="3"ย
ย ย ย ย ย ย ย ย ย ย ย ย ย maxlength="500"></textarea>

ย ย ย ย ย ย ย ย <div id="signupMsg" class="msg-box" role="alert" aria-live="assertive"></div>

ย ย ย ย ย ย ย ย <button type="submit"ย
ย ย ย ย ย ย ย ย ย ย ย ย id="submitSignupBtn"ย
ย ย ย ย ย ย ย ย ย ย ย ย class="btn primary-btn">
ย ย ย ย ย ย ย ย ย ย Submit Signup
ย ย ย ย ย ย ย ย </button>
ย ย ย ย ย ย ย ย <button type="button"ย
ย ย ย ย ย ย ย ย ย ย ย ย id="backToSlotsBtn"ย
ย ย ย ย ย ย ย ย ย ย ย ย class="btn secondary-btn">
ย ย ย ย ย ย ย ย ย ย โ Back to Slot Selection
ย ย ย ย ย ย ย ย </button>
ย ย ย ย ย ย </form>
ย ย ย ย </section>

ย ย ย ย ย ย ย ย ย ย ย ย <section id="successMessage" class="d-none card" aria-labelledby="success-heading">
ย ย ย ย ย ย <h2 id="success-heading">๐ Booking Confirmed!</h2>
ย ย ย ย ย ย <div id="confirmationDetails" role="status" aria-live="polite"></div>
ย ย ย ย ย ย <button id="resetPageBtn"ย
ย ย ย ย ย ย ย ย ย ย class="btn primary-btn"
ย ย ย ย ย ย ย ย ย ย type="button">
ย ย ย ย ย ย ย ย Book Another Slot
ย ย ย ย ย ย </button>
ย ย ย ย </section>
ย ย </main>
</div>

<script type="module" nonce="RANDOM_NONCE">
ย ย // Entry point - loads only what's needed
ย ย (async function initApp() {
ย ย ย ย const startTime = performance.now();
ย ย ย ยย
ย ย ย ย try {
ย ย ย ย ย ย // Load core modules in parallel
ย ย ย ย ย ย const [config, utils, slots] = await Promise.all([
ย ย ย ย ย ย ย ย import('./config.js'),
ย ย ย ย ย ย ย ย import('./utils.js'),
ย ย ย ย ย ย ย ย import('./slots.js')
ย ย ย ย ย ย ]);
ย ย ย ย ย ยย
ย ย ย ย ย ย console.log('โ Core modules loaded');
ย ย ย ย ย ยย
ย ย ย ย ย ย // Wait for DOM
ย ย ย ย ย ย if (document.readyState === 'loading') {
ย ย ย ย ย ย ย ย await new Promise(resolve => document.addEventListener('DOMContentLoaded', resolve, { once: true }));
ย ย ย ย ย ย }

ย ย ย ย ย ย // UPDATED: Attach event listener for the refresh button, replaces inline onclick (Error 2)
ย ย ย ย ย ย const refreshButton = document.getElementById('reloadAppBtn');
ย ย ย ย ย ย if (refreshButton) {
ย ย ย ย ย ย ย ย refreshButton.addEventListener('click', () => location.reload());
ย ย ย ย ย ย }

ย ย ย ย ย ย // Initialize slots (critical path)
ย ย ย ย ย ย await slots.loadSlots();
ย ย ย ย ย ยย
ย ย ย ย ย ย // Lazy load lookup and signup (only when needed)
ย ย ย ย ย ย const lookupBtn = document.getElementById('lookupToggle');
ย ย ย ย ย ย if (lookupBtn) {
ย ย ย ย ย ย ย ย lookupBtn.addEventListener('click', async () => {
ย ย ย ย ย ย ย ย ย ย if (!window.__lookupLoaded) {
ย ย ย ย ย ย ย ย ย ย ย ย console.log('๐ฆ Lazy loading lookup module...');
ย ย ย ย ย ย ย ย ย ย ย ย await import('./lookup.js');
ย ย ย ย ย ย ย ย ย ย ย ย window.__lookupLoaded = true;
ย ย ย ย ย ย ย ย ย ย }
ย ย ย ย ย ย ย ย }, { once: true });
ย ย ย ย ย ย }
ย ย ย ย ย ยย
ย ย ย ย ย ย // Lazy load signup when user selects a slot
ย ย ย ย ย ย window.addEventListener('showSignupForm', async () => {
ย ย ย ย ย ย ย ย if (!window.__signupLoaded) {
ย ย ย ย ย ย ย ย ย ย console.log('๐ฆ Lazy loading signup module...');
ย ย ย ย ย ย ย ย ย ย await import('./signup-frontend.js');
ย ย ย ย ย ย ย ย ย ย window.__signupLoaded = true;
ย ย ย ย ย ย ย ย }
ย ย ย ย ย ย }, { once: true });
ย ย ย ย ย ยย
ย ย ย ย ย ย // Expose debug helpers
ย ย ย ย ย ย window.__APP__ = {
ย ย ย ย ย ย ย ย loadSlots: slots.loadSlots,
ย ย ย ย ย ย ย ย forceReload: slots.forceReloadSlots,
ย ย ย ย ย ย ย ย getState: config.getStateSnapshot,
ย ย ย ย ย ย ย ย cleanup: () => {
ย ย ย ย ย ย ย ย ย ย slots.cleanup();
ย ย ย ย ย ย ย ย ย ย console.log('๐งน App cleaned up');
ย ย ย ย ย ย ย ย }
ย ย ย ย ย ย };
ย ย ย ย ย ยย
ย ย ย ย ย ย const loadTime = performance.now() - startTime;
ย ย ย ย ย ย console.log(`๐ App initialized in ${loadTime.toFixed(0)}ms`);
ย ย ย ย ย ยย
ย ย ย ย } catch (error) {
ย ย ย ย ย ย console.error('โ App initialization failed:', error);
ย ย ย ย ย ย const loadingMsg = document.getElementById('loadingMsg');
ย ย ย ย ย ย if (loadingMsg) {
ย ย ย ย ย ย ย ย // UPDATED: Replaced inline styles and onclick handler
ย ย ย ย ย ย ย ย loadingMsg.innerHTML = `
ย ย ย ย ย ย ย ย ย ย <div class="msg-box error error-box" role="alert">
ย ย ย ย ย ย ย ย ย ย ย ย โ๏ธ Failed to load application. Please refresh the page.
ย ย ย ย ย ย ย ย ย ย ย ย <br><br>
ย ย ย ย ย ย ย ย ย ย ย ย <button id="reloadAppBtn" class="btn secondary-btn mt-15" type="button">
ย ย ย ย ย ย ย ย ย ย ย ย ย ย ๐ Refresh Page
ย ย ย ย ย ย ย ย ย ย ย ย </button>
ย ย ย ย ย ย ย ย ย ย </div>
ย ย ย ย ย ย ย ย `;
ย ย ย ย ย ย }
ย ย ย ย }
ย ย })();
</script>

<noscript>
ย ย ย ย <div class="error-msg-container">
ย ย ย ย <h2>โ๏ธ JavaScript Required</h2>
ย ย ย ย <p>This booking system requires JavaScript to function. Please enable JavaScript in your browser settings.</p>
ย ย </div>
</noscript>
</body>
</html>
